{% extends "base.html" %}
{% block content %}

<div class="container py-5">
    <div class="row">
        <div class="col-lg-7">
                    <div class="d-flex align-items-center mb-4">
                        <a href="{{ url_for('services') }}" class="btn btn-outline-primary me-3">
                            <i class="fas fa-arrow-left me-2"></i>Back to Services
                        </a>
                    </div>
                    <h1 class="display-5 fw-bold mb-2">{{ service.title }}</h1>
                    <p class="text-muted">{{ service.description }}</p>

                    {# Image area: carousel when multiple images, single image when one #}
                    {% if service.images and service.images|length > 1 %}
                    <div id="serviceCarousel" class="carousel slide mb-4 shadow-sm rounded" style="max-height: 400px; overflow: hidden;" data-bs-ride="carousel">
                        <div class="carousel-indicators">
                            {% for img in service.images %}
                            <button type="button" data-bs-target="#serviceCarousel" data-bs-slide-to="{{ loop.index0 }}" {% if loop.first %}class="active" aria-current="true"{% endif %} aria-label="Slide {{ loop.index }}"></button>
                            {% endfor %}
                        </div>
                        <div class="carousel-inner">
                            {% for img in service.images %}
                            <div class="carousel-item {% if loop.first %}active{% endif %}">
                                <a href="#" data-bs-toggle="modal" data-bs-target="#imageModal" data-img-src="{{ url_for('static', filename='images/' ~ img) }}" data-img-title="{{ service.title }} - Image {{ loop.index }}">
                                    <img src="{{ url_for('static', filename='images/' ~ img) }}" class="d-block w-100 rounded img-hover-zoom" style="object-fit: cover; height: 400px;" alt="{{ service.title }} image {{ loop.index }}">
                                </a>
                            </div>
                            {% endfor %}
                        </div>
                        <button class="carousel-control-prev" type="button" data-bs-target="#serviceCarousel" data-bs-slide="prev">
                            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                            <span class="visually-hidden">Previous</span>
                        </button>
                        <button class="carousel-control-next" type="button" data-bs-target="#serviceCarousel" data-bs-slide="next">
                            <span class="carousel-control-next-icon" aria-hidden="true"></span>
                            <span class="visually-hidden">Next</span>
                        </button>
                    </div>
                    {% elif service.images and service.images|length == 1 %}
                    <div class="mb-4" style="max-height: 400px; overflow: hidden;">
                        <a href="#" data-bs-toggle="modal" data-bs-target="#imageModal" data-img-src="{{ url_for('static', filename='images/' ~ service.images[0]) }}" data-img-title="{{ service.title }}">
                            <img src="{{ url_for('static', filename='images/' ~ service.images[0]) }}" class="img-fluid rounded shadow-sm img-hover-zoom" style="object-fit: cover; height: 400px; width: 100%;" alt="{{ service.title }}">
                        </a>
                    </div>
                    {% else %}
                    <div class="mb-4">
                        <div class="ratio ratio-16x9 bg-light d-flex align-items-center justify-content-center rounded shadow-sm">
                            <div class="text-center text-muted">No image available</div>
                        </div>
                    </div>
                    {% endif %}

                    {# Long description #}
                    {% if service.long_description %}
                    <div class="mb-4">
                        <h5>Overview</h5>
                        <p class="text-muted">{{ service.long_description }}</p>
                    </div>
                    {% endif %}

                    {# Features: use service.features if present, otherwise sensible defaults #}
                    <div class="mb-4">
                        <h5>Key Benefits</h5>
                        <div class="row">
                            {% set features = service.features if service.features is defined else ['Scalability & Flexibility','Real-time Inventory Visibility','Cost Optimisation'] %}
                            {% for f in features %}
                            <div class="col-sm-6 mb-2">
                                <div class="d-flex align-items-start">
                                    <div class="me-3 text-primary fs-4"><i class="fas fa-check-circle"></i></div>
                                    <div>{{ f }}</div>
                                </div>
                            </div>
                            {% endfor %}
                        </div>
                    </div>

                    {# Small stats / counters #}
                    <div class="row text-center mb-4">
                        <div class="col-4">
                            <div class="h2 mb-0 counter" data-target="99">99</div>
                            <div class="text-muted small">On-time %</div>
                        </div>
                        <div class="col-4">
                            <div class="h2 mb-0 counter" data-target="1500">1500</div>
                            <div class="text-muted small">Shipments / day</div>
                        </div>
                        <div class="col-4">
                            <div class="h2 mb-0 counter" data-target="50000">50000</div>
                            <div class="text-muted small">SKUs managed</div>
                        </div>
                    </div>

                </div>

                <div class="col-lg-5">
                    {# Contact card with a modal trigger for quick contact #}
                    <div class="card shadow-sm mb-4 sticky-lg-top" style="top: 100px;">
                        <div class="card-body">
                            <h5 class="card-title">Get a tailored proposal</h5>
                            <p class="card-text text-muted">Tell us your volumes, locations and timelines — we'll propose a solution.</p>
                            <div class="d-grid gap-2">
                                <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#contactModal">Request Proposal</button>
                                <a href="{{ url_for('contact') }}" class="btn btn-outline-secondary">Contact Page</a>
                            </div>
                            <hr>
                            <h6 class="mb-1">Get an instant quote</h6>
                            <p class="small text-muted mb-2">Fill a quick form and we'll respond within 24 hours.</p>
                            <form method="post" action="{{ url_for('contact') }}">
                                <input type="hidden" name="service" value="{{ service.title }}">
                                <div class="mb-2">
                                    <input name="name" class="form-control form-control-sm" placeholder="Name" required>
                                </div>
                                <div class="mb-2">
                                    <input name="email" type="email" class="form-control form-control-sm" placeholder="Email" required>
                                </div>
                                <div class="mb-2">
                                    <input name="phone" class="form-control form-control-sm" placeholder="Phone" required>
                                </div>
                                <div class="d-grid">
                                    <button class="btn btn-success btn-sm" type="submit">Request Quote</button>
                                </div>
                            </form>
                        </div>
                    </div>

                    {# FAQ accordion #}
                    <div class="accordion" id="faqAccordion">
                        <div class="accordion-item">
                            <h2 class="accordion-header" id="faqHeadingOne">
                              <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faqOne" aria-expanded="false" aria-controls="faqOne">
                                How quickly can you onboard?
                              </button>
                            </h2>
                            <div id="faqOne" class="accordion-collapse collapse" aria-labelledby="faqHeadingOne" data-bs-parent="#faqAccordion">
                              <div class="accordion-body">Typical onboarding ranges from 2-8 weeks depending on integrations and warehouse readiness.</div>
                            </div>
                        </div>
                        <div class="accordion-item">
                            <h2 class="accordion-header" id="faqHeadingTwo">
                              <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faqTwo" aria-expanded="false" aria-controls="faqTwo">
                                Do you integrate with marketplaces?
                              </button>
                            </h2>
                            <div id="faqTwo" class="accordion-collapse collapse" aria-labelledby="faqHeadingTwo" data-bs-parent="#faqAccordion">
                              <div class="accordion-body">Yes — we support API integrations with major marketplaces and courier partners.</div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>

        {# Contact Modal #}
        <div class="modal fade" id="contactModal" tabindex="-1" aria-labelledby="contactModalLabel" aria-hidden="true">
          <div class="modal-dialog modal-lg modal-dialog-centered">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="contactModalLabel">Request a proposal for {{ service.title }}</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
              </div>
              <div class="modal-body">
                <form method="post" action="{{ url_for('contact') }}">
                    <input type="hidden" name="service" value="{{ service.title }}">
                    <div class="row g-3">
                        <div class="col-md-6"><input name="name" class="form-control" placeholder="Name" required></div>
                        <div class="col-md-6"><input name="email" type="email" class="form-control" placeholder="Email" required></div>
                        <div class="col-md-6"><input name="phone" class="form-control" placeholder="Phone" required></div>
                        <div class="col-md-6"><input name="company" class="form-control" placeholder="Company (optional)"></div>
                        <div class="col-12"><textarea name="message" class="form-control" rows="4" placeholder="Tell us about volumes, SKUs, and locations"></textarea></div>
                    </div>
                    <div class="mt-3 text-end">
                        <button type="button" class="btn btn-secondary me-2" data-bs-dismiss="modal">Close</button>
                        <button type="submit" class="btn btn-primary">Send Request</button>
                    </div>
                </form>
              </div>
            </div>
          </div>
        </div>

        {# Inline JS for animated counters (keeps it lightweight) #}
        {# Image Modal for enlarged view #}
        <div class="modal fade" id="imageModal" tabindex="-1" aria-hidden="true">
            <div class="modal-dialog modal-xl modal-dialog-centered">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title"></h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body p-0">
                        <img src="" class="w-100" alt="">
                    </div>
                </div>
            </div>
        </div>



{% endblock %}
